# Self Review

コード変更をセルフレビューする。Gemini CLI + Claude subagentのデュアルレビューで多角的に検証。

## 実行手順

### 1. 変更差分を確認

```bash
git diff --name-only HEAD
git diff --stat HEAD
```

### 2. Gemini CLI レビュー（外部モデル視点）

```bash
git diff HEAD -- "*.dart" | gemini -p "
以下のコード変更をレビューしてください。

## 観点（すべてチェック）

### 1. コード品質
- 可読性（理解しやすいか）
- 命名（適切な変数名・関数名）
- 構造化（適切な分割・責務分離）

### 2. バグ・エラー
- null安全性
- エッジケース
- 例外処理
- メモリリーク

### 3. 設計パターン
- アーキテクチャ整合性
- 依存関係の適切さ
- 重複コード

## 出力形式
- 重大な問題: [ファイル:行] [問題の説明と修正提案]
- 軽微な問題: [ファイル:行] [問題の説明]
- 問題なし: 'LGTM'

日本語で回答してください。
"
```

### 3. Claude subagent レビュー（別コンテキスト視点）

Task toolで general-purpose subagent を起動し、以下のプロンプトでレビュー:

- 変更ファイル一覧と差分を渡す
- 共通観点（コード品質、バグ、設計パターン）+ プロジェクト固有観点でレビュー

### 4. 結果統合

両レビューの結果を比較・統合:
- 共通の指摘
- Geminiのみの指摘
- subagentのみの指摘

### 5. 判定

| 判定 | 条件 | アクション |
|------|------|----------|
| PASS | 両方LGTM | タスク完了可 |
| MINOR | 軽微な問題のみ | 警告表示後、完了可 |
| FAIL | 重大な問題あり | 修正後、再レビュー |
